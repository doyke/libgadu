#-----------------------------------------------------------------------------
# Empty contact list
#-----------------------------------------------------------------------------

call {
	gg_notify(session, NULL, 0);
}

expect data (12 00 00 00, 00 00 00 00)

#-----------------------------------------------------------------------------

call {
	gg_notify_ex(session, NULL, NULL, 0);
}

expect data (12 00 00 00, 00 00 00 00)

#-----------------------------------------------------------------------------
# Small contact list
#-----------------------------------------------------------------------------

call {
	uint32_t uins[3] = { 0x111111, 0x222222, 0x333333 };
	gg_notify(session, uins, 3);
}

expect data (10 00 00 00, 0f 00 00 00, 11 11 11 00 03, 22 22 22 00 03, 33 33 33 00 03)

#-----------------------------------------------------------------------------

call {
	uint32_t uins[3] = { 0x111111, 0x222222, 0x333333 };
	char types[3] = { GG_USER_NORMAL, GG_USER_OFFLINE, GG_USER_BLOCKED };
	gg_notify_ex(session, uins, types, 3);
}

expect data (10 00 00 00, 0f 00 00 00, 11 11 11 00 03, 22 22 22 00 01, 33 33 33 00 04)

#-----------------------------------------------------------------------------
# Large contact list (> 400 contacts)
#-----------------------------------------------------------------------------

call {
	uint32_t uins[401];
	int i;

	for (i = 0; i < 401; i++)
		uins[i] = 0x03030303;

	gg_notify(session, uins, 401);
}

expect data (0f 00 00 00, d0 07 00 00, 03*2000)

expect data (10 00 00 00, 05 00 00 00, 03 03 03 03 03)

#-----------------------------------------------------------------------------

call {
	uint32_t uins[401];
	char types[401];
	int i;

	for (i = 0; i < 401; i++) {
		uins[i] = 0x01010101;
		types[i] = 0x01;
	}

	gg_notify_ex(session, uins, types, 401);
}

expect data (0f 00 00 00, d0 07 00 00, 01*2000)

expect data (10 00 00 00, 05 00 00 00, 01 01 01 01 01)

#-----------------------------------------------------------------------------
# Status change (pre-6.0)
#-----------------------------------------------------------------------------

send (02 00 00 00, 08 00 00 00, 11 11 11 00, 14 00 00 00)

expect event GG_EVENT_STATUS (
	status.uin == 0x00111111
	status.status == GG_STATUS_INVISIBLE
	status.descr == NULL
)

send (02 00 00 00, 0b 00 00 00, 11 11 11 00, 16 00 00 00, 41 42 43)

expect event GG_EVENT_STATUS (
	status.uin == 0x00111111
	status.status == GG_STATUS_INVISIBLE_DESCR
	status.descr == "ABC"
)

send (02 00 00 00, 0c 00 00 00, 11 11 11 00, 16 00 00 00, 41 42 43 00)

expect event GG_EVENT_STATUS (
	status.uin == 0x00111111
	status.status == GG_STATUS_INVISIBLE_DESCR
	status.descr == "ABC"
)

send (02 00 00 00, 07 00 00 00, 00*7)

expect event GG_EVENT_NONE

#-----------------------------------------------------------------------------
# Status change (6.0)
#-----------------------------------------------------------------------------

send (0f 00 00 00, 0e 00 00 00, 11 11 11 00, 14, 7f 00 00 01, 34 12, 2a, ff, 00)

expect event GG_EVENT_STATUS60 (
	status60.uin == 0x00111111
	status60.status == GG_STATUS_INVISIBLE
	status60.remote_ip == inet_addr("127.0.0.1")
	status60.remote_port == 0x1234
	status60.version == 0x2a
	status60.image_size == 0xff
	status60.descr == NULL
)

send (0f 00 00 00, 11 00 00 00, 11 11 11 00, 16, 7f 00 00 01, 34 12, 2a, ff, 00, 41 42 43)

expect event GG_EVENT_STATUS60 (
	status60.uin == 0x00111111
	status60.status == GG_STATUS_INVISIBLE_DESCR
	status60.remote_ip == inet_addr("127.0.0.1")
	status60.remote_port == 0x1234
	status60.version == 0x2a
	status60.image_size == 0xff
	status60.descr == "ABC"
)

send (0f 00 00 00, 12 00 00 00, 11 11 11 00, 16, 7f 00 00 01, 34 12, 2a, ff, 00, 41 42 43 00)

expect event GG_EVENT_STATUS60 (
	status60.uin == 0x00111111
	status60.status == GG_STATUS_INVISIBLE_DESCR
	status60.remote_ip == inet_addr("127.0.0.1")
	status60.remote_port == 0x1234
	status60.version == 0x0000002a
	status60.image_size == 0x000000ff
	status60.descr == "ABC"
)

send (0f 00 00 00, 0d 00 00 00, 00*13)

expect event GG_EVENT_NONE

