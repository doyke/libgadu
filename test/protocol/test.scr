#-----------------------------------------------------------------------------
# Simple login
#-----------------------------------------------------------------------------
login (uin = 0x123456, password = "")
expect connect
send (01 00 00 00, 04 00 00 00, 12 34 56 78)
expect data (19 00 00 00, 5c 00 00 00, 56 34 12 00, 02, 9b ce 73 d0 c8 b9 ec a4 f2 41 54 f3 bd 3b 8a a4 73 b1 c3 a9 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00, 02 00 00 00, 2a 00 00 00, 00, 00 00 00 00, 00 00, 00 00 00 00, 00 00, 00, be)
send (03 00 00 00, 00 00 00 00)
expect event GG_EVENT_CONN_SUCCESS

#-----------------------------------------------------------------------------
# Sending message
#-----------------------------------------------------------------------------

call {
	gg_send_message(session, GG_CLASS_CHAT, 0x123456, (unsigned char*) "Test");
}

expect data (0b 00 00 00, 11 00 00 00, 56 34 12 00, xx xx xx xx, 08 00 00 00, 54 65 73 74 00)

#-----------------------------------------------------------------------------
# Receiving message
#-----------------------------------------------------------------------------

send (0a 00 00 00, 14 00 00 00, 11 11 11 11, 22 22 22 22, 33 33 33 33, 44 44 44 44, 41 42 43 00)

expect event GG_EVENT_MSG (
	msg.sender == 0x11111111
	msg.seq == 0x22222222
	msg.time == 0x33333333
	msg.msgclass == 0x44444444
	msg.message == "ABC"

	msg.recipients_count == 0
	msg.recipients == NULL

	msg.formats_length == 0
	msg.formats == NULL
)

#-----------------------------------------------------------------------------
# Receiving message without null-termination
#-----------------------------------------------------------------------------

send (0a 00 00 00, 13 00 00 00, 11 11 11 11, 22 22 22 22, 33 33 33 33, 44 44 44 44, 31 32 33)

expect event GG_EVENT_MSG (
	msg.message == "123"
)

#-----------------------------------------------------------------------------
# Logging off
#-----------------------------------------------------------------------------

logoff
expect disconnect
